const TicketControl = require('../models/ticket-control');

//esta instancia es unica cada vez que se reinicia el backend!
const ticketControl = new TicketControl()

const socketController = (socket) => {

    //se ejecuta cuando un cliente se conecta!
    console.log('Cliente conectado!', socket.id)

    socket.on('disconnect', () => {
        console.log('client disconnected!', socket.id)
    })

    //listener del msj enviado desde el cliente!
    //el callback se ejecuta cuando todo se ejecuta bien en el cliente que emite!
    socket.on('enviar-mensaje', (payload, callback) => {

        const id = 12345
        //esta funcion le manda informacion al callback del cliente!
        //esta funcion se ejecuta en el mismo cliente que es enviado!
        callback(id)

        //el servido de sockets emite el evento
        //envia a todos los clientes menos al cliente emisor!
        socket.broadcast.emit('enviar-mensaje-server', payload)
    })
}

module.exports = socketController;

//mandar msj a todos los clientes conectados! desde el server
//this.io.emit('enviar-mensaje-server',payload)